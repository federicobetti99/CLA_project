function est = mc_estimator(A, N, ests)
% This function computes a Monte Carlo estimator for diag(inv(A))
% 
%   A: input matrix
%   N: number of Monte Carlo samples    
%
   n = size(A, 1);
   est = 0;
   for l = 1 : N
       z = (rand(1, n) < .5) * 2 - 1;  % sample from Rademacher distribution
       y = pcg_solve(A, z, 1e-10, 200); % solve iteratively linear system involving A
       est = est + y .* z;  % update with current point-wise multiplication
   end
   est = est / N;
end